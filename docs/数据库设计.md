# 悬壶数据同步数据库

[[_TOC_]]

### xuanhu_database_connection 数据库连接表

```sql
-- 在此接口时POST /system/index/list 分页查询病案信息列表
-- 在此接口时GET /system/index/{id} 获取患者信息详细信息
CREATE TABLE `xuanhu_database_connection`
(
    `id`                 bigint UNSIGNED                                               NOT NULL AUTO_INCREMENT COMMENT '主键',
    `name`               varchar(200) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci NOT NULL DEFAULT '' COMMENT '连接名称',
    `type`               varchar(200) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci NOT NULL DEFAULT '' COMMENT '数据库类型',
    `version`            varchar(255) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci NOT NULL DEFAULT '' COMMENT '驱动版本',
    `driver`             varchar(200) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci NOT NULL DEFAULT '' COMMENT '驱动类名称',
    `address`            varchar(200) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci NOT NULL DEFAULT '' COMMENT '连接地址',
    `port`               varchar(20) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci  NOT NULL DEFAULT '' COMMENT '连接端口号',
    `database_name`      varchar(200) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci NOT NULL DEFAULT '' COMMENT '数据库名',
    `character_encoding` varchar(20) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci  NOT NULL DEFAULT '' COMMENT '编码格式',
    `url`                longtext CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci     NULL COMMENT 'jdbc-url连接串',
    `username`           varchar(200) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci NOT NULL DEFAULT '' COMMENT '连接账号',
    `password`           varchar(200) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci NOT NULL DEFAULT '' COMMENT '账号密码',
    `create_time`        timestamp                                                     NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time`        timestamp                                                     NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
    PRIMARY KEY (`id`) USING BTREE,
    UNIQUE INDEX `name` (`name` ASC) USING BTREE
) ENGINE = InnoDB
  AUTO_INCREMENT = 2
  CHARACTER SET = utf8mb3
  COLLATE = utf8mb3_general_ci COMMENT = '数据库连接信息'
  ROW_FORMAT = Dynamic;

```

### xuanhu_system_user 系统用户表

```sql

CREATE TABLE `xuanhu_system_user`
(
    `id`          bigint                                                                  NOT NULL AUTO_INCREMENT COMMENT '主键id',
    `username`    varchar(255) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci           NOT NULL COMMENT '名称',
    `password`    varchar(128) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci           NOT NULL COMMENT '密码',
    `role`        enum ('admin','super') CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci NOT NULL DEFAULT 'admin' COMMENT '角色',
    `real_name`   varchar(255) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci           NOT NULL DEFAULT '' COMMENT '实际姓名',
    `email`       varchar(255) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci           NOT NULL DEFAULT '' COMMENT '电子邮箱',
    `address`     varchar(255) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci           NOT NULL DEFAULT '' COMMENT '所在地址',
    `locked`      tinyint(1)                                                              NOT NULL DEFAULT 0 COMMENT '是否锁定',
    `create_time` timestamp                                                               NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time` timestamp                                                               NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
    PRIMARY KEY (`id`) USING BTREE,
    UNIQUE INDEX `username` (`username` ASC) USING BTREE
) ENGINE = InnoDB
  AUTO_INCREMENT = 2
  CHARACTER SET = utf8mb3
  COLLATE = utf8mb3_general_ci COMMENT = '系统用户表'
  ROW_FORMAT = DYNAMIC;
role:super-超级管理员, admin-管理员
```

### xuanhu_schedule_job 定时任务表

```sql
CREATE TABLE `xuanhu_schedule_job`
(
    `id`              bigint                                                        NOT NULL AUTO_INCREMENT COMMENT '任务id',
    `job_name`        varchar(255) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci NULL     DEFAULT NULL COMMENT '任务名称',
    `cron_expression` varchar(255) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci NULL     DEFAULT NULL COMMENT 'cron表达式',
    `db_source`       varchar(255) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci NULL     DEFAULT NULL COMMENT '源头数据库',
    `db_dest`         varchar(255) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci NULL     DEFAULT NULL COMMENT '目标数据库',
    `status`          tinyint                                                       NOT NULL DEFAULT 0 COMMENT '状态 0 启动 1 停止',
    `user_id`         bigint                                                        NOT NULL COMMENT '创建人id 关联user',
    `create_time`     timestamp                                                     NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `update_time`     timestamp                                                     NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    `del_flag`        tinyint                                                       NOT NULL DEFAULT 0 COMMENT '软删除标记 0 正常 1 删除',
    `db_source_info`  bigint                                                        NOT NULL COMMENT '源头任务设置信息',
    `db_dest_info`    bigint                                                        NOT NULL COMMENT '目标任务设置信息',
    PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB
  AUTO_INCREMENT = 2
  CHARACTER SET = utf8mb3
  COLLATE = utf8mb4_0900_ai_ci COMMENT = '定时任务'
  ROW_FORMAT = DYNAMIC;
```

